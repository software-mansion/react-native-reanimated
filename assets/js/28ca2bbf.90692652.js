"use strict";(globalThis.webpackChunkdocs_reanimated=globalThis.webpackChunkdocs_reanimated||[]).push([[3153],{1900:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"shared-element-transitions/overview","title":"Shared Element Transitions","description":"Shared Element Transitions is an experimental feature available behind a feature flag, not recommended for production use yet. We are waiting for your feedback to improve the implementation.","source":"@site/docs/shared-element-transitions/overview.mdx","sourceDirName":"shared-element-transitions","slug":"/shared-element-transitions/overview","permalink":"/react-native-reanimated/docs/shared-element-transitions/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/software-mansion/react-native-reanimated/edit/main/docs/docs-reanimated/docs/shared-element-transitions/overview.mdx","tags":[],"version":"current","frontMatter":{"id":"overview","title":"Shared Element Transitions","sidebar_label":"Overview"},"sidebar":"tutorialSidebar","previous":{"title":"Shared Element Transitions","permalink":"/react-native-reanimated/docs/category/shared-element-transitions"},"next":{"title":"Utilities","permalink":"/react-native-reanimated/docs/category/utilities"}}');var a=t(47671),r=t(30620),o=t(25560);const s={id:"overview",title:"Shared Element Transitions",sidebar_label:"Overview"},l=void 0,c={},d=[{value:"Reference",id:"reference",level:2},{value:"Overview",id:"overview",level:2},{value:"Usage",id:"usage",level:2},{value:"Custom animation",id:"custom-animation",level:2},{value:"Example",id:"example",level:2},{value:"Current limitations",id:"current-limitations",level:2},{value:"Platform Compatibility",id:"platform-compatibility",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{CollapsibleCode:t,ExampleVideo:i,PlatformCompatibility:s}=n;return t||g("CollapsibleCode",!0),i||g("ExampleVideo",!0),s||g("PlatformCompatibility",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsxs)(n.p,{children:["Shared Element Transitions is an experimental feature available ",(0,a.jsx)(n.a,{href:"/docs/guides/feature-flags#enable_shared_element_transitions",children:"behind a feature flag"}),", not recommended for production use yet. We are waiting for your feedback to improve the implementation."]})}),"\n",(0,a.jsx)(n.p,{children:"Shared Element Transitions allow you to smoothly transform a component from one screen into a component on another screen."}),"\n",(0,a.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:'import Animated from \'react-native-reanimated\';\n\nconst Stack = createNativeStackNavigator();\n\nfunction One({ navigation }) {\n  return (\n    <>\n      <Animated.View\n        // highlight-start\n        sharedTransitionTag="sharedTag"\n        // highlight-end\n      />\n      <Button title="Two" onPress={() => navigation.navigate(\'Two\')} />\n    </>\n  );\n}\n\nfunction Two({ navigation }) {\n  return (\n    <>\n      <Animated.View\n        // highlight-start\n        sharedTransitionTag="sharedTag"\n        // highlight-end\n      />\n      <Button title="One" onPress={() => navigation.navigate(\'One\')} />\n    </>\n  );\n}\n\nexport default function SharedElementExample() {\n  return (\n    <NavigationContainer>\n      <Stack.Navigator>\n        <Stack.Screen name="One" component={One} />\n        <Stack.Screen name="Two" component={Two} />\n      </Stack.Navigator>\n    </NavigationContainer>\n  );\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(n.p,{children:["When Reanimated detects that the current top screen on the stack changes, it checks if there are components with the same ",(0,a.jsx)(n.code,{children:"sharedTransitionTag"})," on the new and old top screen."]}),"\n",(0,a.jsx)(n.p,{children:"If it finds two matching components, it hides both of them by changing their opacity and creates a third view, that is displayed over the view hierarchy, that looks exactly like the source view, and is then animated to look like the target view. This implementation detail is subject to change as we might want to avoid creating a redundant instance of the same component."}),"\n",(0,a.jsx)(n.p,{children:"After the animation is complete, the third view is removed, and the opacity of both original views is restored."}),"\n",(0,a.jsxs)(n.p,{children:["Currently you can't define a fully custom animation function. You can however customize the duration and use spring-based animations. You can expect ",(0,a.jsx)(n.code,{children:"width"}),", ",(0,a.jsx)(n.code,{children:"height"}),", ",(0,a.jsx)(n.code,{children:"originX"}),", ",(0,a.jsx)(n.code,{children:"originY"}),", ",(0,a.jsx)(n.code,{children:"transform"}),", ",(0,a.jsx)(n.code,{children:"backgroundColor"})," and ",(0,a.jsx)(n.code,{children:"opacity"})," to be animated by default with a duration of 500 ms using the ",(0,a.jsx)(n.a,{href:"/docs/animations/withTiming/",children:(0,a.jsx)(n.code,{children:"withTiming"})})," animation function."]}),"\n",(0,a.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsxs)(n.p,{children:["To create a shared transition animation between two components on different screens, simply assign the same ",(0,a.jsx)(n.code,{children:"sharedTransitionTag"})," to both components. When you navigate between screens, the shared transition animation will automatically play."]}),"\n",(0,a.jsxs)(n.p,{children:["If you want to use more than one shared view on the same screen, be sure to assign a ",(0,a.jsx)(n.strong,{children:"unique"})," shared tag to each component."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Screen A"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"{2}",children:"<Animated.View\n  sharedTransitionTag=\"sharedTag\"\n  style={{ width: 150, height: 150, backgroundColor: 'green' }}\n/>\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Screen B"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",metastring:"{2}",children:"<Animated.View\n  sharedTransitionTag=\"sharedTag\"\n  style={{ width: 100, height: 100, backgroundColor: 'green' }}\n/>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"custom-animation",children:"Custom animation"}),"\n",(0,a.jsxs)(n.p,{children:["You can customize the transition with the ",(0,a.jsx)(n.code,{children:"SharedTransition"})," builder class. The available customization will be extended as the feature matures."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-tsx",children:"import { SharedTransition } from 'react-native-reanimated';\n\nconst transition = SharedTransition.duration(550).springify();\n\nfunction SharedView() {\n  return (\n    <Animated.View\n      sharedTransitionTag=\"reanimatedTransition\"\n      // highlight-next-line\n      sharedTransitionStyle={transition}\n      style={{ backgroundColor: 'blue', width: 200, height: 100 }}\n    />\n  );\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"On iOS, when the animation is triggered by a swipe gesture or the OS back button we instead run a progress-based transition. This way the animation responds to the user swiping their finger accordingly, and allows for transition cancellation. This behavior will be possible to customize in the future."}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example"}),"\n","\n",(0,a.jsx)(i,{sources:{android:"/react-native-reanimated/recordings/android_shared_element_transition.mov",ios:"/react-native-reanimated/recordings/ios_shared_element_transition.mov"}}),"\n",(0,a.jsx)(t,{src:o.A,showLines:[48,78]}),"\n",(0,a.jsx)(n.h2,{id:"current-limitations",children:"Current limitations"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Only the ",(0,a.jsx)(n.a,{href:"https://reactnavigation.org/docs/native-stack-navigator/",children:"native stack"})," is supported."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.a,{href:"https://reactnavigation.org/docs/bottom-tab-navigator/",children:"Tab navigator"})," is not supported yet, using it in on path that uses shared transitions may result in no animation being ran."]}),"\n",(0,a.jsxs)(n.li,{children:["Transitions with native modals (using ",(0,a.jsx)(n.code,{children:"transparentModal"}),") don't work properly on iOS (the modal is obstructing the Shared Element)."]}),"\n",(0,a.jsx)(n.li,{children:"You can't define custom animation functions."}),"\n",(0,a.jsxs)(n.li,{children:["Some properties (e.g. ",(0,a.jsx)(n.code,{children:"backgroundColor"}),") are not supported in progress-based transitions."]}),"\n",(0,a.jsx)(n.li,{children:"On iOS you can encounter some issues with the vertical positioning of transitioning views. This is due to issues with header height information propagation."}),"\n",(0,a.jsx)(n.li,{children:"There are some performance bottlenecks, that stem from transforms being recalculated too eagerly."}),"\n",(0,a.jsx)(n.li,{children:"We have to use a workaround for react-native-screens to not keep a snapshot of the transitioning view on the popped screen. Currently the fix is available in 3.19+ versions."}),"\n",(0,a.jsxs)(n.li,{children:["Enabling the feature flag causes the ",(0,a.jsx)(n.code,{children:"zIndex"})," of views with exiting animations to change (they are brought to the front). This differs from the current behavior in Reanimated 4."]}),"\n",(0,a.jsx)(n.li,{children:"Sometimes on a fast refresh, the transition will run for elements that are on the same screen. It can happen when the navigator is wrapped with a context provider, and the native view that represents the screen changed, so the SET logic was triggered."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"platform-compatibility",children:"Platform Compatibility"}),"\n",(0,a.jsx)(s,{android:!0,ios:!0})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}function g(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},25560:(e,n,t)=>{t.d(n,{A:()=>i});const i="import * as React from 'react';\nimport { View, Text, StyleSheet, Pressable, Dimensions } from 'react-native';\nimport type { NativeStackScreenProps } from '@react-navigation/native-stack';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport Animated, { FadeIn } from 'react-native-reanimated';\n\ntype StackParamList = {\n  Home: undefined;\n  Details: { tag: Tag };\n};\n\nconst Stack = createNativeStackNavigator<StackParamList>();\n\nconst gallery = {\n  florence: {\n    color: '#b58df1',\n    title: 'Beautiful city of Florence',\n    description:\n      'Florence was a centre of medieval European trade and finance and one of the wealthiest cities of that era.',\n  },\n  countryside: {\n    color: '#82cab2',\n    title: 'Tuscan countryside',\n    description:\n      \"Tuscany's picturesque hills attract millions of tourists each year craving postcard-perfect views.\",\n  },\n  dawn: {\n    color: '#87cce8',\n    title: 'Tuscany at dawn',\n    description:\n      'Tuscany is known for its magical mists in the morning and at sunset.',\n  },\n};\n\ntype Tag = keyof typeof gallery;\n\nfunction HomeScreen({\n  navigation,\n}: NativeStackScreenProps<StackParamList, 'Home'>) {\n  const chips = ['Italy', 'Tourism', 'Nature'];\n  const goToDetails = (tag: Tag) => {\n    navigation.navigate('Details', { tag });\n  };\n\n  const { width } = Dimensions.get('screen');\n\n  return (\n    <Animated.ScrollView style={styles.homeContainer}>\n      <Pressable onPress={() => goToDetails('countryside')}>\n        <Animated.View\n          sharedTransitionTag={'countryside'}\n          style={[\n            styles.imageOne,\n            { backgroundColor: gallery.countryside.color },\n          ]}\n        />\n      </Pressable>\n      <View style={styles.row}>\n        <Pressable onPress={() => goToDetails('florence')}>\n          <Animated.View\n            sharedTransitionTag={'florence'}\n            style={[\n              { width: width / 2 - 35 },\n              styles.imageTwo,\n              { backgroundColor: gallery.florence.color },\n            ]}\n          />\n        </Pressable>\n        <Pressable onPress={() => goToDetails('dawn')}>\n          <Animated.View\n            sharedTransitionTag={'dawn'}\n            style={[\n              { width: width / 2 - 35 },\n              styles.imageThree,\n              { backgroundColor: gallery.dawn.color },\n            ]}\n          />\n        </Pressable>\n      </View>\n      <Text style={styles.header}>Tuscany</Text>\n      <View style={styles.row}>\n        {chips.map((chip) => (\n          <Text key={chip} style={styles.chip}>\n            {chip}\n          </Text>\n        ))}\n      </View>\n      <Text style={styles.text}>\n        Tuscany is known for its landscapes, history, artistic legacy, and its\n        influence on high culture. It is regarded as the birthplace of the\n        Italian Renaissance and of the foundations of the Italian language.\n      </Text>\n    </Animated.ScrollView>\n  );\n}\n\nfunction DetailsScreen({\n  route,\n  navigation,\n}: NativeStackScreenProps<StackParamList, 'Details'>) {\n  const { tag } = route.params;\n\n  return (\n    <View style={styles.detailContainer}>\n      <Animated.View\n        sharedTransitionTag={tag}\n        style={[styles.detailsImage, { backgroundColor: gallery[tag].color }]}\n      />\n      <View style={styles.wrapper}>\n        <Animated.Text\n          entering={FadeIn.delay(150).duration(1000)}\n          style={[styles.header, styles.font28]}>\n          {gallery[tag].title}\n        </Animated.Text>\n        <Animated.Text\n          entering={FadeIn.delay(300).duration(1000)}\n          style={styles.text}>\n          {gallery[tag].description}\n        </Animated.Text>\n        <Animated.View\n          entering={FadeIn.delay(500).duration(1000)}\n          style={styles.callToActionWrapper}>\n          <Pressable\n            style={styles.callToAction}\n            onPress={() => navigation.goBack()}>\n            <Text style={styles.callToActionText}>see for yourself</Text>\n          </Pressable>\n        </Animated.View>\n      </View>\n    </View>\n  );\n}\n\nexport default function GalleryExample() {\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n      }}>\n      <Stack.Screen name=\"Home\" component={HomeScreen} />\n      <Stack.Screen name=\"Details\" component={DetailsScreen} />\n    </Stack.Navigator>\n  );\n}\n\nconst styles = StyleSheet.create({\n  homeContainer: {\n    flex: 1,\n    marginHorizontal: 25,\n  },\n  detailContainer: {\n    flex: 1,\n  },\n  wrapper: {\n    flex: 1,\n    marginHorizontal: 25,\n  },\n  row: {\n    flexDirection: 'row',\n  },\n  header: {\n    fontSize: 40,\n    fontWeight: 'bold',\n    marginTop: 25,\n    marginBottom: 12,\n  },\n  text: {\n    fontSize: 16,\n    marginTop: 8,\n  },\n  font28: {\n    fontSize: 28,\n  },\n  chip: {\n    borderWidth: 1,\n    borderColor: '#ccc',\n    padding: 8,\n    width: 90,\n    borderRadius: 5,\n    textAlign: 'center',\n    marginRight: 8,\n  },\n  detailsImage: {\n    width: '100%',\n    height: 400,\n  },\n  callToActionWrapper: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginTop: 30,\n  },\n  callToAction: {\n    backgroundColor: '#add8e6',\n    padding: 16,\n    width: 250,\n    borderRadius: 5,\n  },\n  callToActionText: {\n    color: '#015571',\n    textAlign: 'center',\n    textTransform: 'uppercase',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n  imageOne: {\n    width: '100%',\n    height: 160,\n    marginTop: 20,\n    borderRadius: 15,\n  },\n  imageTwo: {\n    height: 250,\n    marginTop: 20,\n    borderRadius: 15,\n  },\n  imageThree: {\n    height: 250,\n    marginTop: 20,\n    marginLeft: 20,\n    borderRadius: 15,\n  },\n});\n"},30620:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var i=t(39471);const a={},r=i.createContext(a);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);