"use strict";(self.webpackChunkdocs_reanimated=self.webpackChunkdocs_reanimated||[]).push([[5424],{30620:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>r});var o=n(39471);const t={},s=o.createContext(t);function a(e){const i=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:i},e.children)}},60355:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"guides/building-on-windows","title":"Building for Android on Windows","description":"This article provides basic troubleshooting steps for issues that may happen when building React Native apps with Reanimated for Android devices on Windows host machine.","source":"@site/versioned_docs/version-3.x/guides/building-for-android-on-windows.md","sourceDirName":"guides","slug":"/guides/building-on-windows","permalink":"/react-native-reanimated/docs/3.x/guides/building-on-windows","draft":false,"unlisted":false,"editUrl":"https://github.com/software-mansion/react-native-reanimated/edit/main/docs/docs-reanimated/versioned_docs/version-3.x/guides/building-for-android-on-windows.md","tags":[],"version":"3.x","frontMatter":{"id":"building-on-windows","title":"Building for Android on Windows","sidebar_label":"Building for Android on Windows"},"sidebar":"tutorialSidebar","previous":{"title":"Accessibility","permalink":"/react-native-reanimated/docs/3.x/guides/accessibility"},"next":{"title":"Compatibility","permalink":"/react-native-reanimated/docs/3.x/guides/compatibility"}}');var t=n(47671),s=n(30620);const a={id:"building-on-windows",title:"Building for Android on Windows",sidebar_label:"Building for Android on Windows"},r=void 0,d={},l=[{value:"What should you definitely not do?",id:"what-should-you-definitely-not-do",level:2},{value:"\u274c Do not disable New Architecture if it&#39;s already enabled",id:"-do-not-disable-new-architecture-if-its-already-enabled",level:3},{value:"\u274c Do not downgrade Android Gradle Plugin",id:"-do-not-downgrade-android-gradle-plugin",level:3},{value:"\u274c Do not downgrade Reanimated or any other dependency",id:"-do-not-downgrade-reanimated-or-any-other-dependency",level:3},{value:"\u274c Do not post another &quot;same issue&quot; comment",id:"-do-not-post-another-same-issue-comment",level:3},{value:"What should you do then?",id:"what-should-you-do-then",level:2},{value:"\u2705 Make sure your environment is set up correctly",id:"-make-sure-your-environment-is-set-up-correctly",level:3},{value:"\u2705 Use appropriate version of Reanimated",id:"-use-appropriate-version-of-reanimated",level:3},{value:"\u2705 Use appropriate version of CMake",id:"-use-appropriate-version-of-cmake",level:3},{value:"\u2705 Use appropriate version of Ninja",id:"-use-appropriate-version-of-ninja",level:3},{value:"\u2705 Use appropriate version of Android NDK",id:"-use-appropriate-version-of-android-ndk",level:3},{value:"\u2705 Make sure <code>_JAVA_OPTIONS</code> environmental variable is not set",id:"-make-sure-_java_options-environmental-variable-is-not-set",level:3},{value:"\u2705 Enable long paths support in Windows registry",id:"-enable-long-paths-support-in-windows-registry",level:3},{value:"\u2705 Make sure that project path doesn&#39;t contain any whitespace",id:"-make-sure-that-project-path-doesnt-contain-any-whitespace",level:3},{value:"\u2705 Make sure that project path is not too long",id:"-make-sure-that-project-path-is-not-too-long",level:3},{value:"\u2705 Remove or invalidate caches",id:"-remove-or-invalidate-caches",level:3},{value:"\u26a0\ufe0f I have followed all of the above steps and it still doesn&#39;t work",id:"\ufe0f-i-have-followed-all-of-the-above-steps-and-it-still-doesnt-work",level:3}];function c(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{children:"This article provides basic troubleshooting steps for issues that may happen when building React Native apps with Reanimated for Android devices on Windows host machine."}),"\n",(0,t.jsx)(i.p,{children:"There are many possible errors including, but not limited to:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"Execution failed for task ':react-native-reanimated:buildCMakeDebug[x86_64]"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"Execution failed for task ':react-native-reanimated:buildCMakeRelWithDebInfo[arm64-v8a]'"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"Task :react-native-reanimated:buildCMakeDebug[x86_64] FAILED"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"C/C++: ninja: error: mkdir(...): No such file or directory"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"C++ build system [build] failed while executing"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"Picked up _JAVA_OPTIONS"})}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"what-should-you-definitely-not-do",children:"What should you definitely not do?"}),"\n",(0,t.jsxs)(i.p,{children:["If you stumble across any of the above errors or similar, please don't disable or downgrade any features or dependencies. Here are some of examples of what ",(0,t.jsx)(i.strong,{children:"not"})," to do:"]}),"\n",(0,t.jsx)(i.h3,{id:"-do-not-disable-new-architecture-if-its-already-enabled",children:"\u274c Do not disable New Architecture if it's already enabled"}),"\n",(0,t.jsxs)(i.p,{children:["Starting from React Native 0.76, New Architecture is enabled by default. Disabling it manually by changing ",(0,t.jsx)(i.code,{children:"newArchEnabled=..."})," in ",(0,t.jsx)(i.code,{children:"gradle.properties"})," does not fix the problem, it just postpones it as the legacy architecture will be removed in a future release of React Native."]}),"\n",(0,t.jsx)(i.h3,{id:"-do-not-downgrade-android-gradle-plugin",children:"\u274c Do not downgrade Android Gradle Plugin"}),"\n",(0,t.jsxs)(i.p,{children:["It is not recommended to change the version of Android Gradle Plugin (AGP) by modifying ",(0,t.jsx)(i.code,{children:"distributionUrl=..."})," in ",(0,t.jsx)(i.code,{children:"gradle.properties"}),". You should use the version of AGP used in the official app template. Changing the AGP version will lead to other problems, including version conflicts and unsupported features."]}),"\n",(0,t.jsx)(i.h3,{id:"-do-not-downgrade-reanimated-or-any-other-dependency",children:"\u274c Do not downgrade Reanimated or any other dependency"}),"\n",(0,t.jsx)(i.p,{children:"Downgrading the dependencies increases the technical debt of your project. Newer version of Reanimated contain various bug fixes and are more stable than previous releases. You should always try to use the latest supported version of Reanimated in your app. In fact, you should try upgrading all the dependencies to the latest available rather than downgrading them."}),"\n",(0,t.jsx)(i.h3,{id:"-do-not-post-another-same-issue-comment",children:'\u274c Do not post another "same issue" comment'}),"\n",(0,t.jsx)(i.p,{children:'Before you report an error, search for similar issues on GitHub, Stack Overflow, Google, etc. Instead posting another "same issue" comment which will be marked as spam, just add a reaction under the original issue. This way we know how many developers are affected which lets us prioritize our work.'}),"\n",(0,t.jsx)(i.h2,{id:"what-should-you-do-then",children:"What should you do then?"}),"\n",(0,t.jsx)(i.h3,{id:"-make-sure-your-environment-is-set-up-correctly",children:"\u2705 Make sure your environment is set up correctly"}),"\n",(0,t.jsxs)(i.p,{children:["First all, make sure that you have followed all instructions in ",(0,t.jsx)(i.a,{href:"https://reactnative.dev/docs/set-up-your-environment",children:"Set Up Your Environment"}),". Run ",(0,t.jsx)(i.code,{children:"npx react-native doctor"})," to see if there are any problems. Make sure to open a new terminal, restart Visual Studio Code or your IDE, or even reboot your computer if changes have been applied."]}),"\n",(0,t.jsx)(i.h3,{id:"-use-appropriate-version-of-reanimated",children:"\u2705 Use appropriate version of Reanimated"}),"\n",(0,t.jsx)(i.p,{children:"Make sure to use latest supported version of Reanimated, depending on the setup of your app."}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"If your app uses Expo SDK"}),", you must use a specific major and minor version of Reanimated (first and second number). For instance, Expo SDK 52 supports only Reanimated 3.16.x. Make sure to update to the latest available patch version (third number), for instance 3.16.7."]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{style:{textAlign:"center"},children:"Expo SDK version"}),(0,t.jsx)(i.th,{style:{textAlign:"center"},children:"Reanimated version"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"52"})}),(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"~3.16.1"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"51"})}),(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"~3.10.1"})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"50"})}),(0,t.jsx)(i.td,{style:{textAlign:"center"},children:(0,t.jsx)(i.code,{children:"~3.6.2"})})]})]})]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["How to determine which version is compatible? Open ",(0,t.jsx)(i.a,{href:"https://github.com/expo/expo/blob/sdk-52/packages/expo/bundledNativeModules.json",children:"https://github.com/expo/expo/blob/sdk-52/packages/expo/bundledNativeModules.json"})," file, jump to ",(0,t.jsx)(i.code,{children:"sdk-XX"})," branch and search for ",(0,t.jsx)(i.code,{children:'"react-native-reanimated"'}),"."]})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"If your project uses Expo prebuild or React Native without a framework (e.g. React Native Community CLI)"}),", you should use a version of Reanimated that is compatible with the version of React Native according to the ",(0,t.jsx)(i.a,{href:"/docs/guides/compatibility",children:"Compatibility table"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["For instance, Reanimated 3.15.x works only with React Native 0.72, 0.73, 0.74 or 0.75 and ",(0,t.jsx)(i.strong,{children:"is not"})," compatible with React Native 0.76. If you want to use Reanimated with React Native 0.76, you need to upgrade to at least 3.16.0. It is recommended to use the latest available version (in this case, 3.16.7)."]}),"\n",(0,t.jsx)(i.h3,{id:"-use-appropriate-version-of-cmake",children:"\u2705 Use appropriate version of CMake"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.a,{href:"https://cmake.org/",children:"CMake"})," is a build system used to compile the C++ part of Reanimated on your machine. Make sure to use CMake ",(0,t.jsx)(i.code,{children:"3.22.1"})," or newer. CMake version can be customized with ",(0,t.jsx)(i.code,{children:"CMAKE_VERSION"})," environmental variable, e.g. using ",(0,t.jsx)(i.code,{children:"set CMAKE_VERSION=3.31.1"}),". If not set, CMake ",(0,t.jsx)(i.code,{children:"3.22.1"})," is used."]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsx)(i.p,{children:"CMake will be installed automatically during app build. You can install a specific version of CMake directly from Android Studio (Tools \u2192 SDK Manager \u2192 SDK Tools \u2192 CMake)."})}),"\n",(0,t.jsx)(i.h3,{id:"-use-appropriate-version-of-ninja",children:"\u2705 Use appropriate version of Ninja"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.a,{href:"https://ninja-build.org/",children:"Ninja"})," is a build system used to compile the C++ part of Reanimated on your machine. Make sure to use Ninja ",(0,t.jsx)(i.code,{children:"1.12.0"})," or newer (current latest is ",(0,t.jsx)(i.code,{children:"1.12.1"}),") as some older versions of Ninja do not handle long paths correctly (see ",(0,t.jsx)(i.a,{href:"https://github.com/ninja-build/ninja/issues/1900",children:"this issue on GitHub"}),")."]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["See ",(0,t.jsx)(i.a,{href:"https://github.com/ninja-build/ninja/issues/1900#issuecomment-1817532728",children:"this comment on GitHub"})," for instructions on how to use a different version of Ninja."]})}),"\n",(0,t.jsx)(i.h3,{id:"-use-appropriate-version-of-android-ndk",children:"\u2705 Use appropriate version of Android NDK"}),"\n",(0,t.jsx)(i.p,{children:"Android NDK (Native Development Kit) is a set of tools used for building the native part of the app. You should use the same version of NDK as used in the official app template."}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsx)(i.p,{children:'Android NDK should be installed automatically during app build. You can install a specific version of Android NDK directly from Android Studio (Tools \u2192 SDK Manager \u2192 SDK Tools \u2192 "NDK (Side by side)").'})}),"\n",(0,t.jsxs)(i.h3,{id:"-make-sure-_java_options-environmental-variable-is-not-set",children:["\u2705 Make sure ",(0,t.jsx)(i.code,{children:"_JAVA_OPTIONS"})," environmental variable is not set"]}),"\n",(0,t.jsxs)(i.p,{children:["Some developers stated that unsetting ",(0,t.jsx)(i.code,{children:"_JAVA_OPTIONS"})," environmental variable fixes the errors and makes the build pass."]}),"\n",(0,t.jsx)(i.h3,{id:"-enable-long-paths-support-in-windows-registry",children:"\u2705 Enable long paths support in Windows registry"}),"\n",(0,t.jsxs)(i.p,{children:["See ",(0,t.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry#enable-long-paths-in-windows-10-version-1607-and-later",children:"this page"})," for instructions on how to enable support for long paths on Windows."]}),"\n",(0,t.jsx)(i.h3,{id:"-make-sure-that-project-path-doesnt-contain-any-whitespace",children:"\u2705 Make sure that project path doesn't contain any whitespace"}),"\n",(0,t.jsxs)(i.p,{children:["The build process may not work properly for paths with space characters. Spaces often appear in usernames, for example ",(0,t.jsx)(i.code,{children:"C:\\Users\\Szczepan Czekan"}),", or project names, for instance ",(0,t.jsx)(i.code,{children:"D:\\Mobile Apps\\My Awesome Project"}),". In such case, move the project to another directory that does not contain whitespace."]}),"\n",(0,t.jsx)(i.h3,{id:"-make-sure-that-project-path-is-not-too-long",children:"\u2705 Make sure that project path is not too long"}),"\n",(0,t.jsxs)(i.p,{children:["The build process may not work properly for paths that are too long. Actually, CMake will raise a warning when it comes across a path longer than 240 characters. In such case, move the project or clone the repository again to a location with shorter path, for example ",(0,t.jsx)(i.code,{children:"D:\\AwesomeProject"}),"."]}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["On Windows, you can mount a specific directory (e.g. ",(0,t.jsx)(i.code,{children:"C:\\Users\\Tomek\\AwesomeProject"}),") as a drive (e.g. ",(0,t.jsx)(i.code,{children:"H:"}),") using the following command: ",(0,t.jsx)(i.code,{children:"subst H: C:\\Users\\Tomek\\AwesomeProject"})]})}),"\n",(0,t.jsx)(i.h3,{id:"-remove-or-invalidate-caches",children:"\u2705 Remove or invalidate caches"}),"\n",(0,t.jsx)(i.p,{children:"During app build, multiple compilation artifacts are saved in various paths, for instance:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"android\\build"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"android\\.cxx"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"android\\.gradle"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"android\\app\\build"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"android\\app\\.cxx"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"node_modules\\react-native-reanimated\\android\\build"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"node_modules\\react-native-reanimated\\android\\.cxx"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"C:\\Users\\Tomek\\.gradle\\caches"})}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Make sure to remove these directories and their contents before trying to build the app again."}),"\n",(0,t.jsx)(i.p,{children:"It is also recommended to invalidate Android Studio caches (File \u2192 Invalidate Caches\u2026 \u2192 Select all checkboxes \u2192 Invalidate and Restart)."}),"\n",(0,t.jsx)(i.admonition,{type:"tip",children:(0,t.jsxs)(i.p,{children:["You can remove all untracked files in your repository using ",(0,t.jsx)(i.code,{children:"git clean -fdX"})," command. Note that this command will remove all untracked files including hidden files like ",(0,t.jsx)(i.code,{children:".env"})," so please be extra careful and proceed with caution when doing so. You will also need to reinstall ",(0,t.jsx)(i.code,{children:"node_modules"})," afterwards using your chosen package manager and rebuild the app."]})}),"\n",(0,t.jsx)(i.h3,{id:"\ufe0f-i-have-followed-all-of-the-above-steps-and-it-still-doesnt-work",children:"\u26a0\ufe0f I have followed all of the above steps and it still doesn't work"}),"\n",(0,t.jsxs)(i.p,{children:["If you still have problems with building for Android device on a Windows machine, please ",(0,t.jsx)(i.a,{href:"https://github.com/software-mansion/react-native-reanimated/issues/new?template=bug-report.yml",children:"submit an issue"})," in our repository. Make sure to provide full build logs and preferably a minimal viable reproducible example so we can replicate and investigate your issue."]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);